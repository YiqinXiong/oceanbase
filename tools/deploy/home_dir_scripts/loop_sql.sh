#! /bin/bash
# parameter 1: loop times
if [ -z $1 ]
then
    echo "MISSING ARGUMENT: loop times"
    echo "log on : \$1=1000 for about 20 sec"
    echo "log off: \$1=3000 for about 30 sec"
    exit -1
fi

OBIP="127.0.0.1"
OBPORT="43700"
OBUSER="root@mytpch"
OBDATABASE="xyq"
OB="/data/2/xiongyiqin.xyq/workspace/oceanbase/deps/3rd/u01/obclient/bin/obclient -h $OBIP -P $OBPORT"
OB_TPC="$OB -u$OBUSER -D$OBDATABASE -f -c -A -s"
# TEST_SQL="echo \"select * from t1;\""
#TEST_SQL="cat /home/xiongyiqin.xyq/downloads/tpc-test/tpc-tool/tpch-tool/queries-mysql/q01.sql"
#TEST_SQL="echo select p_brand, p_type, p_retailprice from part where p_retailprice in (1800,1900,2000);"
#TEST_SQL='echo select p_brand, p_type, p_retailprice from part where p_type in ("SMALL BRUSHED COPPER", "SMALL BRUSHED COPPDR", "MEDIUM POLISHED STEEL");'
#TEST_SQL="echo select raw_int from tinghua where raw_int in (-98234401, -153429912, -1000000499, -1000000500);"
TEST_SQL="echo select raw_char from tinghua where raw_char in ('K2ClzME3','OLQH6MQ-', 'abcdEfgh', 'what-oyo');"
#TEST_SQL="echo select raw_int from tinghua where raw_int in (-98234401, -153429912, -505734920, 927932735, -179653533, 336831572, 198213900, -405940550, 102655255, -781120511, 679530111, -720968100, -111105927, 787168068, -275793852, 453943964, -16090841, 711263317, 278215467, 257363608, -27072559, 193248100, -481611044, -995318864, 351037596, 750806073, -915384752, -993733725, 418092704, -185095769, -460446501, -655180245, 980902291, -490588039, -915678225, -881352688, 418412803, -718508388, 938773366, 67153942, -149761414, -575468061, -843485768, 419657234, 925990881, 872417130, 459594888, 146437284, 885588911, -116695414, 508089082, 244040637, 662964416, -517480113, -331750016, 669531325, 273943696, -458684647, -145974371, -699893923, -23958455, -250504102, 745669014, 659067066, 384214122, -33411694, -706559524, -479284736, 205057564, -891603298, 372311110, 658368693, -507834672, 886938415, -688650883, 882205802, -500955099, 611895391, 719105945, -411489880, 424997449, 136257623, -860775910, -226909621, -318714487, 950907230, 631443811, 49809911, 862491978, -398878834, 400414369, 36145563, -254057696, 478348963, -530470321, 729836752, -720946501, 690533676, 201012830, -569753802, -1000000201, -1000000202, -1000000203, -1000000204, -1000000205, -1000000206, -1000000207, -1000000208, -1000000209, -1000000210, -1000000211, -1000000212, -1000000213, -1000000214, -1000000215, -1000000216, -1000000217, -1000000218, -1000000219, -1000000220, -1000000221, -1000000222, -1000000223, -1000000224, -1000000225, -1000000226, -1000000227, -1000000228, -1000000229, -1000000230, -1000000231, -1000000232, -1000000233, -1000000234, -1000000235, -1000000236, -1000000237, -1000000238, -1000000239, -1000000240, -1000000241, -1000000242, -1000000243, -1000000244, -1000000245, -1000000246, -1000000247, -1000000248, -1000000249, -1000000250, -1000000251, -1000000252, -1000000253, -1000000254, -1000000255, -1000000256, -1000000257, -1000000258, -1000000259, -1000000260, -1000000261, -1000000262, -1000000263, -1000000264, -1000000265, -1000000266, -1000000267, -1000000268, -1000000269, -1000000270, -1000000271, -1000000272, -1000000273, -1000000274, -1000000275, -1000000276, -1000000277, -1000000278, -1000000279, -1000000280, -1000000281, -1000000282, -1000000283, -1000000284, -1000000285, -1000000286, -1000000287, -1000000288, -1000000289, -1000000290, -1000000291, -1000000292, -1000000293, -1000000294, -1000000295, -1000000296, -1000000297, -1000000298, -1000000299, -1000000300, -1000000301, -1000000302, -1000000303, -1000000304, -1000000305, -1000000306, -1000000307, -1000000308, -1000000309, -1000000310, -1000000311, -1000000312, -1000000313, -1000000314, -1000000315, -1000000316, -1000000317, -1000000318, -1000000319, -1000000320, -1000000321, -1000000322, -1000000323, -1000000324, -1000000325, -1000000326, -1000000327, -1000000328, -1000000329, -1000000330, -1000000331, -1000000332, -1000000333, -1000000334, -1000000335, -1000000336, -1000000337, -1000000338, -1000000339, -1000000340, -1000000341, -1000000342, -1000000343, -1000000344, -1000000345, -1000000346, -1000000347, -1000000348, -1000000349, -1000000350, -1000000351, -1000000352, -1000000353, -1000000354, -1000000355, -1000000356, -1000000357, -1000000358, -1000000359, -1000000360, -1000000361, -1000000362, -1000000363, -1000000364, -1000000365, -1000000366, -1000000367, -1000000368, -1000000369, -1000000370, -1000000371, -1000000372, -1000000373, -1000000374, -1000000375, -1000000376, -1000000377, -1000000378, -1000000379, -1000000380, -1000000381, -1000000382, -1000000383, -1000000384, -1000000385, -1000000386, -1000000387, -1000000388, -1000000389, -1000000390, -1000000391, -1000000392, -1000000393, -1000000394, -1000000395, -1000000396, -1000000397, -1000000398, -1000000399, -1000000400, -1000000401, -1000000402, -1000000403, -1000000404, -1000000405, -1000000406, -1000000407, -1000000408, -1000000409, -1000000410, -1000000411, -1000000412, -1000000413, -1000000414, -1000000415, -1000000416, -1000000417, -1000000418, -1000000419, -1000000420, -1000000421, -1000000422, -1000000423, -1000000424, -1000000425, -1000000426, -1000000427, -1000000428, -1000000429, -1000000430, -1000000431, -1000000432, -1000000433, -1000000434, -1000000435, -1000000436, -1000000437, -1000000438, -1000000439, -1000000440, -1000000441, -1000000442, -1000000443, -1000000444, -1000000445, -1000000446, -1000000447, -1000000448, -1000000449, -1000000450, -1000000451, -1000000452, -1000000453, -1000000454, -1000000455, -1000000456, -1000000457, -1000000458, -1000000459, -1000000460, -1000000461, -1000000462, -1000000463, -1000000464, -1000000465, -1000000466, -1000000467, -1000000468, -1000000469, -1000000470, -1000000471, -1000000472, -1000000473, -1000000474, -1000000475, -1000000476, -1000000477, -1000000478, -1000000479, -1000000480, -1000000481, -1000000482, -1000000483, -1000000484, -1000000485, -1000000486, -1000000487, -1000000488, -1000000489, -1000000490, -1000000491, -1000000492, -1000000493, -1000000494, -1000000495, -1000000496, -1000000497, -1000000498, -1000000499, -1000000500);"
LOGFILE="loop_sql.log"
START=`date +%s%N`
for i in $(seq 1 $1) ;
do
    $TEST_SQL | $OB_TPC > $LOGFILE
done
END=`date +%s%N`
time=$((END-START))
time=`echo "scale=2; $time / 1000000000.0" | bc`
end_time=$(date)
echo "$end_time; End of Run Query $QUERY_NO; time: $time sec."
